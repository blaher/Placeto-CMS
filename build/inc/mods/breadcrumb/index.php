<?php function placeto_breadcrumb(){global $config,$prefix;if(isset($_GET['url'])){$location='/'.$_GET['url'];}else{$location=$_SERVER['PHP_SELF'];}while(stristr($location,'../')){$location=str_replace('../','',$location);}$location=str_replace('index.php','',$location);if(($config['directory']!=='/'||$config['directory']==NULL)&&$config['directory']===substr($location,0,strlen($config['directory']))){$location=substr($location,strlen($config['directory']),strlen($location));}if(substr($location,strlen($location)-1)==='/'&&strlen($location)!==1){$location=substr($location,0,strlen($location)-1);}$crumbs=explode('/',$location);$crmlc[0]='/';for($i=0;$i<count($crumbs)&&$location!=='/';$i++){for($n=$i;$n>0;$n--){@$crmlc[$i]='/'.$crumbs[$n].$crmlc[$i];}if($bread=@mysql_fetch_assoc(mysql_query('SELECT * FROM '.$prefix.'mod_breadcrumb WHERE page="'.$crmlc[$i].'"'))){if($i!==count($crumbs)-1){echo '<a href=".',$bread['page'];if((count($crumbs)-$i)>2){echo '" rel="index" rev="subsection">';}else{echo '" rel="index" rev="section">';}echo $bread['title'],"</a> &gt;\n";}else{echo $bread['title'],"\n";}}else if($bread=@mysql_fetch_assoc(mysql_query('SELECT * FROM '.$prefix.'content WHERE page="'.$crmlc[$i].'"'))){if($i!==count($crumbs)-1){echo '<a href=".',$bread['page'];if((count($crumbs)-$i)>2){echo '" rel="index" rev="subsection">';}else{echo '" rel="index" rev="section">';}echo $bread['header'],"</a> &gt;\n";}else{echo $bread['header'],"\n";}}}unset($crumbs,$n,$i,$crmlc,$bread,$location);}?>